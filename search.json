[{"path":"https://alan-turing-institute.github.io/eider/docs/CODE_OF_CONDUCT.html","id":"diversity-statement","dir":"","previous_headings":"","what":"Diversity Statement","title":"NA","text":"encourage everyone participate committed building project . Although fail times, seek treat everyone fairly equally possible. Whenever member made mistake, expect take responsibility . someone harmed offended, responsibility listen carefully respectfully, best right wrong. Although list exhaustive, explicitly honour diversity age, gender, gender identity expression, culture, ethnicity, language, national origin, political beliefs, profession, race, religion, sexual orientation, socioeconomic status, technical ability. tolerate discrimination based protected characteristics , including participants visible invisible disabilities.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"NA","text":"Examples behaviour contributes positive environment community include: Demonstrating empathy kindness toward people respectful differing opinions, viewpoints, experiences Giving gracefully accepting constructive feedback Accepting responsibility apologizing affected mistakes, learning experience Focusing best just us individuals, overall community Examples unacceptable behaviour include: Trolling, insulting derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical email address, without explicit permission conduct reasonably considered inappropriate professional setting use sexualised language imagery, sexual attention advances kind","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"NA","text":"Code Conduct applies members participating activities, events processes taking place within scope repository. Specifically, Code Conduct applies conduct: - interactions within team/community maintaining repo - team activity, communication event related repo - outside team activity team member representing project - members outside team engaging GitHub repository. Code Conduct also applies individual officially representing community public spaces. Examples representing community include using official e-mail address, posting via official social media account, acting appointed representative online offline event.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"NA","text":"Code Conduct uses template created maintained Turing Way team members shared CC-4.0 reuse: https://github.com/alan-turing-institute/reproducible-project-template","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to eider","title":"Contributing to eider","text":"Development work eider carried January March 2024. time writing, active development. like file bug, please open issue GitHub! extremely helpful can include minimum viable example bug . eider often reads data stored local file system, also provide contents files. may include CSV files (input data) JSON files (feature specifications). Otherwise, may difficult impossible pinpoint bug. broader questions package developemnt, feel free create issue, get touch maintainer: means person listed DESCRIPTION file role \"cre\".","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/CONTRIBUTING.html","id":"developer-tools","dir":"","previous_headings":"","what":"Developer tools","title":"Contributing to eider","text":"pre-commit hooks , enabled, ensure commit code inconsistent (e.g. .Rd documentation files sync roxygen2 comments). use , first install pre-commit . make sure devtools lintr packages installed: can set pre-commit hooks run every time committing running (shell, R console).","code":"install.packages(c(\"devtools\", \"lintr\")) pre-commit install"},{"path":"https://alan-turing-institute.github.io/eider/docs/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 Alan Turing Institute Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/combination.html","id":"json-structure","dir":"Articles","previous_headings":"","what":"JSON structure","title":"Combination features","text":"top-level JSON keys specified feature overview, output_feature_name transformation_type still required combination features. , output_feature_name name feature created. value transformation_type can : combine_linear: calculate linear combination features combine_min: calculate minimum features combine_max: calculate maximum features top , combination features require subfeature key, JSON object. keys can string (though helps descriptive), values JSON objects define subfeatures, sans output_feature_name (required). Note subfeature may different source_table key, allows subfeatures come different input tables. linear combinations, subfeature must contain weight key, number determines coefficients feature linear combination.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/combination.html","id":"minimum-and-maximum-combination","dir":"Articles","previous_headings":"","what":"Minimum and maximum combination","title":"Combination features","text":", let’s make data illustrate . Suppose want find number times patient diagnosed “” number times diagnosed “B”, whichever greater. number “” diagnoses ordinarily specified using following JSON: number “B” diagnoses exactly identical , except “” replaced “B”. combination feature seek can thus specified json_examples/combination1.json. subfeature exactly , except output_feature_name key omitted: Running gives us expected values 4 2 two patients respectively:","code":"input_table <- data.frame(   id = c(1, 1, 1, 1, 2, 2, 2, 2),   diagnosis = c(\"A\", \"A\", \"A\", \"A\", \"A\", \"A\", \"B\", \"B\") )  input_table #>   id diagnosis #> 1  1         A #> 2  1         A #> 3  1         A #> 4  1         A #> 5  2         A #> 6  2         A #> 7  2         B #> 8  2         B {     \"output_feature_name\": \"num_A\",     \"source_table\": \"input_table\",     \"transformation_type\": \"count\",     \"absent_default_value\": 0,     \"grouping_column\": \"id\",     \"filter\": {         \"column\": \"diagnosis\",         \"type\": \"in\",         \"value\": [\"A\"]     } } {   \"output_feature_name\": \"max_of_A_and_B\",   \"transformation_type\": \"combine_max\",   \"subfeature\": {     \"num_A\": {       \"source_table\": \"input_table\",       \"grouping_column\": \"id\",       \"transformation_type\": \"count\",       \"absent_default_value\": 0,       \"filter\": {         \"column\": \"diagnosis\",         \"type\": \"in\",         \"value\": [           \"A\"         ]       }     },     \"num_B\": {       \"source_table\": \"input_table\",       \"grouping_column\": \"id\",       \"transformation_type\": \"count\",       \"absent_default_value\": 0,       \"filter\": {         \"column\": \"diagnosis\",         \"type\": \"in\",         \"value\": [           \"B\"         ]       }     }   } } results <- run_pipeline(   data_sources = list(input_table = input_table),   feature_filenames = \"json_examples/combination1.json\" )  results$features #>   id max_of_A_and_B #> 1  1              4 #> 2  2              2"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/combination.html","id":"linear-combination","dir":"Articles","previous_headings":"","what":"Linear combination","title":"Combination features","text":"Linear combinations allow calculate, example, weighted sum two features. Suppose want assign score 10 every “” diagnosis 20 every “B” diagnosis. can use JSON , two minor modifications: transformation_type key set combine_linear weight key added subfeature, appropriate value result json_examples/combination2.json: running : Note simple unweighted sum features, weights can set 1; take difference two features, one weight can set 1 -1.","code":"{   \"output_feature_name\": \"linear\",   \"transformation_type\": \"combine_linear\",   \"subfeature\": {     \"A_score\": {       \"weight\": 10,       \"source_table\": \"input_table\",       \"grouping_column\": \"id\",       \"transformation_type\": \"count\",       \"absent_default_value\": 0,       \"filter\": {         \"column\": \"diagnosis\",         \"type\": \"in\",         \"value\": [           \"A\"         ]       }     },     \"B_score\": {       \"weight\": 20,       \"source_table\": \"input_table\",       \"grouping_column\": \"id\",       \"transformation_type\": \"count\",       \"absent_default_value\": 0,       \"filter\": {         \"column\": \"diagnosis\",         \"type\": \"in\",         \"value\": [           \"B\"         ]       }     }   } } results <- run_pipeline(   data_sources = list(input_table = input_table),   feature_filenames = \"json_examples/combination2.json\" )  results$features #>   id linear #> 1  1     40 #> 2  2     60"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/combination.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See also","title":"Combination features","text":"Feature 3 LTC example vignette example combination feature, case, sum three subfeatures.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/eider.html","id":"data","dir":"Articles","previous_headings":"","what":"Data","title":"Introduction to eider","text":"illustrate , construct simplistic data, may , example, record patients attended GP associated complaints. practice, likely reading data file instead. example, CSV file called attendances.csv current working directory, just : eider allows mix match data sources, data CSV file R data frame: allows user , example, perform preprocessing portion data needed.","code":"example_table <- data.frame(   patient_id        = c(1, 1, 1, 2, 2, 3, 3, 3),   attendance_reason = c(6, 6, 7, 6, 6, 7, 7, 7) )  data_sources <- list(attendances = example_table) data_sources_2 <- list(attendances = \"attendances.csv\") data_sources_3 <- list(   attendances = example_table,   # A variable which has already been constructed   other_data = \"other_data.csv\"  # A file to be read in )"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/eider.html","id":"feature-specification","dir":"Articles","previous_headings":"","what":"Feature specification","title":"Introduction to eider","text":"Suppose want extract feature corresponding total number times patient attended reason 6. eider requires feature specified JSON, looks like : transformation_type tells kind overall operation performed. determines fields required JSON. source_table specifies name data source used list data sources. grouping_column specifies columns group . absent_default_value specifies data particular patient ID. output_feature_name specifies name column created output table. filter filter object used select rows input table match particular conditions. Subsequent vignettes go detail different types transformations required JSON fields .","code":"{   \"transformation_type\": \"count\",   \"source_table\": \"attendances\",   \"grouping_column\": \"patient_id\",   \"absent_default_value\": 0,   \"output_feature_name\": \"total_attendances\",   \"filter\": {     \"column\": \"attendance_reason\",     \"type\": \"in\",     \"value\": [       6     ]   } }"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/eider.html","id":"performing-the-transformation","dir":"Articles","previous_headings":"","what":"Performing the transformation","title":"Introduction to eider","text":"obtain desired feature, can place JSON file (json_examples/eider.json) simply : expected, patients 1 2 attended reason 6 twice, patient 3 . run_pipeline() returns list two data frames, called features responses respectively. refer data used training machine learning models: features independent variables (.e. X), responses dependent variables (.e. y). consistency, eider always returns data frames ensures list IDs. Responses may specified exactly way features, using response_filenames argument instead feature_filenames. alternative placing JSON file providing filename run_pipeline(), can also provide JSON directly string:","code":"run_pipeline(   data_sources = data_sources,   feature_filenames = \"json_examples/eider.json\" ) #> $features #>   id total_attendances #> 1  1                 2 #> 2  2                 2 #> 3  3                 0 #>  #> $responses #>   id #> 1  1 #> 2  2 #> 3  3 json_string <- '{     \"transformation_type\": \"count\",     \"source_table\": \"attendances\",     \"grouping_column\": \"patient_id\",     \"absent_default_value\": 0,     \"output_feature_name\": \"total_attendances\",     \"filter\": {         \"column\": \"attendance_reason\",         \"type\": \"in\",         \"value\": [6]     } }'  run_pipeline(   data_sources = data_sources,   feature_filenames = json_string ) #> $features #>   id total_attendances #> 1  1                 2 #> 2  2                 2 #> 3  3                 0 #>  #> $responses #>   id #> 1  1 #> 2  2 #> 3  3"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/eider.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next steps","title":"Introduction to eider","text":"want read step--step guide features eider, move next vignette, covers different types features eider lets define. Alternatively, jump ahead gallery section see examples features might use eider calculate.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"the-data","dir":"Articles","previous_headings":"","what":"The data","title":"Examples: A&E data","text":"specific vignette, using simulated accident emergency (&E) data. dataset contain every column specified , serves useful example real-life data may treated using eider. (Note data loaded eider, date columns automatically converted date type : need manual processing .) simplified table 6 columns: id, numeric patient ID; date, admission occurred; attendance_category, numeric value indicating context patient’s admission; diagnosis_1, diagnosis_2, diagnosis_3, numeric values indicating patient’s diagnoses. Note diagnosis_2 diagnosis_3 may necessarily exist every entry.","code":"ae_data <- utils::read.csv(ae_data_filepath) |>   dplyr::mutate(date = as.Date(date))  dplyr::glimpse(ae_data) #> Rows: 100 #> Columns: 6 #> $ id                  <int> 15, 1, 18, 1, 11, 11, 17, 15, 9, 14, 3, 13, 13, 15… #> $ date                <date> 2016-03-07, 2016-09-06, 2015-10-23, 2016-02-23, 2… #> $ attendance_category <int> 5, 5, 5, 4, 2, 3, 3, 5, 4, 4, 5, 3, 5, 2, 5, 1, 1,… #> $ diagnosis_1         <int> 7, 5, 6, 16, 15, 8, 16, 0, 18, 14, 14, 12, 1, 8, 0… #> $ diagnosis_2         <int> 19, NA, NA, 2, 6, 5, 18, 12, 3, NA, NA, NA, 3, 9, … #> $ diagnosis_3         <int> 18, NA, NA, NA, 99, NA, 12, 15, 15, NA, NA, NA, NA…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"feature-1-total-number-of-attendances","dir":"Articles","previous_headings":"","what":"Feature 1: Total number of attendances","title":"Examples: A&E data","text":"first example, calculate total number attendances patient. feature may specified JSON follows: JSON file also provided part package, data, can accessed using eider_example() function. contains following information: source_table specifies identifier input table provided eider; output_feature_name specifies name column created output table; absent_default_value specifies value used patient appear table. case, logical value use 0: patient appear &E table, means 0 attendances. grouping_column specifies column table grouped. case, id column. transformation_type specifies way feature calculated. , value \"count\" means number rows id simply counted. one simplest possible features can calculated using eider. can run using run_pipeline() function: described introductory vignette, run_pipeline() function returns features responses. case, provided ae_count_filepath one feature_filenames, data interested returned part res$features. Notice also data_sources argument takes named list. names list used match source_table JSON file actual data. case, source_table \"ae\", need specify data used ae = ae_data_filepath.","code":"ae_count_filepath <- eider_example(\"ae_total_attendances.json\") writeLines(readLines(ae_count_filepath)) #> { #>   \"source_table\": \"ae\", #>   \"transformation_type\": \"count\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"output_feature_name\": \"total_ae_attendances\" #> } res <- run_pipeline(   data_sources = list(ae = ae_data_filepath),   feature_filenames = ae_count_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id                   <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,… #> $ total_ae_attendances <int> 6, 4, 6, 3, 5, 4, 6, 5, 5, 10, 4, 5, 4, 8, 4, 7, …"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"feature-2-total-number-of-neurology-attendances-in-2017","dir":"Articles","previous_headings":"","what":"Feature 2: Total number of neurology attendances in 2017","title":"Examples: A&E data","text":"second example, calculate total number attendances patient : date within 2017; diagnosis pertaining neurology (corresponds diagnosis code 13). , feature still \"count\" transformation. However, must additionally apply filter table performing count, ensure rows interested counted (see filtering vignette examples ).","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"the-date","dir":"Articles","previous_headings":"Feature 2: Total number of neurology attendances in 2017","what":"The date","title":"Examples: A&E data","text":"filter, want constrain date 1 January 2017 31 December 2017. specific filter date range; however, can construct conjunction two subfilters: one restricts date 1 January 2017, one restricts 31 December 2017. filters must simultaneously satisfied; thus, need use \"\" filter: Note names subfilters—\"date1\" \"date2\"—arbitrary; just used distinguish two subfilters. can choose names consider useful.","code":"{     ...,     \"filter\": {         \"type\": \"and\",         \"subfilter\": {             \"date1\": {                 \"column\": \"date\",                 \"type\": \"date_gt_eq\",                 \"value\": \"2017-01-01\"             },             \"date2\": {                 \"column\": \"date\",                 \"type\": \"date_lt_eq\",                 \"value\": \"2017-12-31\"             }         }     } }"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"the-diagnosis","dir":"Articles","previous_headings":"Feature 2: Total number of neurology attendances in 2017","what":"The diagnosis","title":"Examples: A&E data","text":"numeric diagnosis can occur three diagnosis columns, need check three retain rows three diagnosis columns equal 13. accomplished \"\" filter:","code":"{     ...,     \"filter\": {         \"type\": \"or\",         \"subfilter\": {             \"diag1\": {                 \"column\": \"diagnosis_1\",                 \"type\": \"in\",                 \"value\": [13]             },             \"diag2\": {                 \"column\": \"diagnosis_2\",                 \"type\": \"in\",                 \"value\": [13]             },             \"diag3\": {                 \"column\": \"diagnosis_3\",                 \"type\": \"in\",                 \"value\": [13]             }         }     } }"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"combining-both-filters","dir":"Articles","previous_headings":"Feature 2: Total number of neurology attendances in 2017","what":"Combining both filters","title":"Examples: A&E data","text":"combine filters, can nest within \"\" filter. Note can principle simplified, really really need nest filters deeply. However, work correctly, keep .","code":"{     ...,     \"filter\": {         \"type\": \"and\",         \"subfilter\": {             \"date\": {                 \"type\": \"and\",                 \"subfilter\": {                     \"date1\": {                         \"column\": \"date\",                         \"type\": \"date_gt_eq\",                         \"value\": \"2017-01-01\"                     },                     \"date2\": {                         \"column\": \"date\",                         \"type\": \"date_lt_eq\",                         \"value\": \"2017-12-31\"                     }                 }             },             \"diag\": {                 \"type\": \"or\",                 \"subfilter\": {                       \"diag1\": {                           \"column\": \"diagnosis_1\",                           \"type\": \"in\",                           \"value\": [13]                       },                       \"diag2\": {                           \"column\": \"diagnosis_2\",                           \"type\": \"in\",                           \"value\": [13]                       },                       \"diag3\": {                           \"column\": \"diagnosis_3\",                           \"type\": \"in\",                           \"value\": [13]                       }                 }             }         }     } } (date1 AND date2) AND (diag1 OR diag2 OR diag3) date1 AND date2 AND (diag1 OR diag2 OR diag3)"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"the-feature","dir":"Articles","previous_headings":"Feature 2: Total number of neurology attendances in 2017","what":"The feature","title":"Examples: A&E data","text":"JSON file feature provided part package. exactly earlier example, except filter added . feature can run way previous one. make things slightly interesting, provide features run_pipeline() time: case, can see patient 0 (example) 9 total attendances, 1 2017 resulted neurology diagnosis.","code":"ae_neurology_filepath <- eider_example(\"ae_attendances_neurology_2017.json\") writeLines(readLines(ae_neurology_filepath)) #> { #>   \"source_table\": \"ae\", #>   \"transformation_type\": \"count\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"output_feature_name\": \"total_neurology_ae_attendances\", #>   \"filter\": { #>     \"type\": \"and\", #>     \"subfilter\": { #>       \"date\": { #>         \"type\": \"and\", #>         \"subfilter\": { #>           \"date1\": { #>             \"column\": \"date\", #>             \"type\": \"date_gt_eq\", #>             \"value\": \"2017-01-01\" #>           }, #>           \"date2\": { #>             \"column\": \"date\", #>             \"type\": \"date_lt_eq\", #>             \"value\": \"2017-12-31\" #>           } #>         } #>       }, #>       \"diag\": { #>         \"type\": \"or\", #>         \"subfilter\": { #>           \"diag1\": { #>             \"column\": \"diagnosis_1\", #>             \"type\": \"in\", #>             \"value\": [ #>               13 #>             ] #>           }, #>           \"diag2\": { #>             \"column\": \"diagnosis_2\", #>             \"type\": \"in\", #>             \"value\": [ #>               13 #>             ] #>           }, #>           \"diag3\": { #>             \"column\": \"diagnosis_3\", #>             \"type\": \"in\", #>             \"value\": [ #>               13 #>             ] #>           } #>         } #>       } #>     } #>   } #> } res <- run_pipeline(   data_sources = list(ae = ae_data_filepath),   feature_filenames = c(ae_count_filepath, ae_neurology_filepath) )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 3 #> $ id                             <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 1… #> $ total_ae_attendances           <int> 6, 4, 6, 3, 5, 4, 6, 5, 5, 10, 4, 5, 4,… #> $ total_neurology_ae_attendances <int> 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, …"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"checking-the-results-so-far","dir":"Articles","previous_headings":"","what":"Checking the results (so far)","title":"Examples: A&E data","text":"can verify results using standard dplyr pipeline. feature 1: feature 2: tells us patients 0 2 ones neurology attendances 2017, consistent feature table eider calculated. However, notice eider taken care joining features together inserting missing value 0 necessary. Using eider also helps avoid errors can easily creep data mutated long script.","code":"ae_data |>   dplyr::group_by(id) |>   dplyr::summarise(total_ae_attendances = dplyr::n()) |>   dplyr::glimpse() #> Rows: 20 #> Columns: 2 #> $ id                   <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,… #> $ total_ae_attendances <int> 6, 4, 6, 3, 5, 4, 6, 5, 5, 10, 4, 5, 4, 8, 4, 7, … ae_data |>   dplyr::filter(date >= \"2017-01-01\", date <= \"2017-12-31\") |>   dplyr::filter(diagnosis_1 == 13 | diagnosis_2 == 13 | diagnosis_3 == 13) |>   dplyr::group_by(id) |>   dplyr::summarise(total_neurology_ae_attendances = dplyr::n()) |>   dplyr::glimpse() #> Rows: 2 #> Columns: 2 #> $ id                             <int> 2, 6 #> $ total_neurology_ae_attendances <int> 1, 1"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"feature-3-whether-a-patient-has-ever-attended-ae","dir":"Articles","previous_headings":"","what":"Feature 3: Whether a patient has ever attended A&E","title":"Examples: A&E data","text":"slight modification first feature, can also calculate whether patient ever attended &E. binary feature, values either 1 (patient attended &E) 0 (). need replace transformation_type \"present\" (instead \"count\"):","code":"ae_present_filepath <- eider_example(\"has_visited_ae.json\") writeLines(readLines(ae_present_filepath)) #> { #>   \"source_table\": \"ae\", #>   \"transformation_type\": \"present\", #>   \"grouping_column\": \"id\", #>   \"output_feature_name\": \"has_visited_ae\" #> } res <- run_pipeline(   data_sources = list(ae = ae_data_filepath),   feature_filenames = ae_present_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id             <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1… #> $ has_visited_ae <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ae.html","id":"feature-4-the-number-of-days-since-the-last-ae-attendance","dir":"Articles","previous_headings":"","what":"Feature 4: The number of days since the last A&E attendance","title":"Examples: A&E data","text":"example completely different transformation type, look \"time_since\" feature type . name suggests, calculates time since event: case, specify “from_first”: “false”“cutoff_date”: “2021-03-25” calculate time since last event 25 March 2021; \"time_units\": \"days\" return value days. \"date_column\" specifies name column input table contains date attendance. default value patients appear dataset , logically, set something large, indicate recent &E attendance. case use 2000.","code":"days_since_ae_filepath <- eider_example(\"days_since_last_ae.json\") writeLines(readLines(days_since_ae_filepath)) #> { #>   \"source_table\": \"ae\", #>   \"grouping_column\": \"id\", #>   \"transformation_type\": \"time_since\", #>   \"time_units\": \"days\", #>   \"from_first\": false, #>   \"output_feature_name\": \"days_since_last_ae_visit\", #>   \"date_column\": \"date\", #>   \"cutoff_date\": \"2021-03-25\", #>   \"absent_default_value\": 2000 #> } res <- run_pipeline(   data_sources = list(ae = ae_data_filepath),   feature_filenames = days_since_ae_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id                       <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,… #> $ days_since_last_ae_visit <dbl> 1344, 1661, 1223, 1428, 1569, 1349, 1220, 125…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ltc.html","id":"the-data","dir":"Articles","previous_headings":"","what":"The data","title":"Examples: LTC data","text":"specific vignette, using simulated long-term condition (LTC) data. dataset contain every column specified , serves useful example real-life data may treated using eider. (Note data loaded eider, date columns automatically converted date type : need manual processing .) simplified table 4 columns: id, numeric patient ID; asthma, diabetes, parkinsons, columns dates indicating patient first diagnosed corresponding condition. patient never diagnosed condition, value NA.","code":"ltc_data <- utils::read.csv(ltc_data_filepath) |>   dplyr::mutate(asthma = lubridate::ymd(asthma),                 diabetes = lubridate::ymd(diabetes),                 parkinsons = lubridate::ymd(parkinsons))  dplyr::glimpse(ltc_data) #> Rows: 20 #> Columns: 4 #> $ id         <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1… #> $ asthma     <date> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 2017-07-22, NA… #> $ diabetes   <date> NA, NA, NA, NA, NA, NA, 2015-06-27, 2017-01-19, NA, NA, 20… #> $ parkinsons <date> NA, 2017-05-22, NA, NA, NA, 2015-09-22, NA, NA, 2016-12-08…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ltc.html","id":"feature-1-number-of-years-with-asthma","dir":"Articles","previous_headings":"","what":"Feature 1: Number of years with asthma","title":"Examples: LTC data","text":"example, calculate number years since patient first diagnosed asthma. similar one examples &E data vignette. , use \"time_since\" transformation type, additionally specify \"time_units\" \"years\" obtain result number years (formally, number days divided 365.25). particular example, \"from_first\" parameter set true. patient one row table, ‘first’ row, thus parameter equally well set false. (However, omitted, required parameter \"time_since\" transformation type.)","code":"years_asthma_filepath <- eider_example(\"years_with_asthma.json\") writeLines(readLines(years_asthma_filepath)) #> { #>   \"source_table\": \"ltc\", #>   \"grouping_column\": \"id\", #>   \"transformation_type\": \"time_since\", #>   \"time_units\": \"years\", #>   \"from_first\": true, #>   \"output_feature_name\": \"years_with_asthma\", #>   \"date_column\": \"asthma\", #>   \"cutoff_date\": \"2021-03-25\", #>   \"absent_default_value\": 40 #> } res <- run_pipeline(   data_sources = list(ltc = ltc_data_filepath),   feature_filenames = years_asthma_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id                <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15… #> $ years_with_asthma <dbl> 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 3, 40, 4…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ltc.html","id":"feature-2-whether-a-patient-has-asthma-or-not","dir":"Articles","previous_headings":"","what":"Feature 2: Whether a patient has asthma or not","title":"Examples: LTC data","text":"example slightly interesting involves ingenious filter operation. like binary feature value 1 patient asthma, 0 otherwise. However, simply use \"present\" \"count\" transformation type without filtering, every patient appears table. need first filter table rows NA value appears asthma column removed. However, eider’s filter operation support filtering based NA values! work around , can filter based dates: choose rows date greater sentinel value long time past, genuine dates table pass test, NA values . Thus, need \"date_gt\" filter value suitably far past real date table come .","code":"has_asthma_filepath <- eider_example(\"has_asthma.json\") writeLines(readLines(has_asthma_filepath)) #> { #>   \"source_table\": \"ltc\", #>   \"transformation_type\": \"present\", #>   \"grouping_column\": \"id\", #>   \"output_feature_name\": \"has_asthma\", #>   \"filter\": { #>     \"column\": \"asthma\", #>     \"type\": \"date_gt\", #>     \"value\": \"1800-01-01\" #>   } #> } res <- run_pipeline(   data_sources = list(ltc = ltc_data_filepath),   feature_filenames = has_asthma_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id         <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1… #> $ has_asthma <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_ltc.html","id":"feature-3-number-of-conditions","dir":"Articles","previous_headings":"","what":"Feature 3: Number of conditions","title":"Examples: LTC data","text":"final example, calculate number long-term conditions patient diagnosis . essentially involves calculating one binary 0/1 feature condition (much like Feature 2, summing . Thus, need use \"combine_linear\" transformation type, weights individual feature set 1 (see combination feature vignette information). full JSON looks like : subfeature object contains named list individual features want combine: exactly structure , except filtering performed different column time. individual subfeature also given \"weight\": 1, described previously. Finally, \"output_feature_name\" field lifted top level JSON instead individual subfeature.","code":"num_ltcs_filepath <- eider_example(\"number_of_ltcs.json\") writeLines(readLines(num_ltcs_filepath)) #> { #>   \"transformation_type\": \"combine_linear\", #>   \"output_feature_name\": \"number_of_ltcs\", #>   \"subfeature\": { #>     \"asthma\": { #>       \"weight\": 1, #>       \"source_table\": \"ltc\", #>       \"transformation_type\": \"present\", #>       \"grouping_column\": \"id\", #>       \"filter\": { #>         \"column\": \"asthma\", #>         \"type\": \"date_gt\", #>         \"value\": \"1800-01-01\" #>       } #>     }, #>     \"diabetes\": { #>       \"weight\": 1, #>       \"source_table\": \"ltc\", #>       \"transformation_type\": \"present\", #>       \"grouping_column\": \"id\", #>       \"filter\": { #>         \"column\": \"diabetes\", #>         \"type\": \"date_gt\", #>         \"value\": \"1800-01-01\" #>       } #>     }, #>     \"parkinsons\": { #>       \"weight\": 1, #>       \"source_table\": \"ltc\", #>       \"transformation_type\": \"present\", #>       \"grouping_column\": \"id\", #>       \"filter\": { #>         \"column\": \"parkinsons\", #>         \"type\": \"date_gt\", #>         \"value\": \"1800-01-01\" #>       } #>     } #>   } #> } res <- run_pipeline(   data_sources = list(ltc = ltc_data_filepath),   feature_filenames = num_ltcs_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id             <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1… #> $ number_of_ltcs <dbl> 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 2, 0, 0, 1, 0, 0, 0, 0…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_pis.html","id":"the-data","dir":"Articles","previous_headings":"","what":"The data","title":"Examples: PIS data","text":"specific vignette, using simulated Prescribing Information System (PIS). dataset contain every column specified , serves useful example real-life data may treated using eider. (Note data loaded eider, date columns automatically converted date type : need manual processing .) simplified table 4 columns: id, numeric patient ID; paid_date, date prescription paid ; bnf_section, code type drug prescribed; num_items, number items prescribed.","code":"pis_data <- utils::read.csv(pis_data_filepath) |>   dplyr::mutate(paid_date = lubridate::ymd(paid_date))  dplyr::glimpse(pis_data) #> Rows: 100 #> Columns: 4 #> $ id          <int> 19, 19, 19, 7, 3, 18, 2, 5, 2, 6, 10, 2, 15, 4, 15, 6, 15,… #> $ paid_date   <date> 2017-12-15, 2016-08-11, 2015-07-07, 2017-03-14, 2015-08-0… #> $ bnf_section <int> 113, 106, 105, 112, 111, 106, 108, 104, 109, 110, 109, 115… #> $ num_items   <int> 3, 5, 1, 1, 1, 3, 4, 3, 1, 4, 4, 5, 3, 5, 1, 2, 4, 2, 3, 1…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_pis.html","id":"feature-1-number-of-unique-prescription-types","dir":"Articles","previous_headings":"","what":"Feature 1: Number of unique prescription types","title":"Examples: PIS data","text":"simple example feature number unique prescription type patient received, corresponds number distinct values bnf_section per id. JSON required uses nunique transformation type, must specify column want take distinct values using \"aggregation_column\": \"bnf_section\".","code":"unique_bnf_filepath <- eider_example(\"distinct_bnf_prescriptions.json\") writeLines(readLines(unique_bnf_filepath)) #> { #>   \"source_table\": \"pis\", #>   \"transformation_type\": \"nunique\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"aggregation_column\": \"bnf_section\", #>   \"output_feature_name\": \"unique_bnf_sections\" #> } res <- run_pipeline(   data_sources = list(pis = pis_data_filepath),   feature_filenames = unique_bnf_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id                  <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, … #> $ unique_bnf_sections <int> 3, 3, 4, 6, 2, 5, 3, 2, 5, 2, 4, 1, 4, 4, 3, 6, 3,…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_pis.html","id":"feature-2-number-of-drugs-prescribed-since-2016","dir":"Articles","previous_headings":"","what":"Feature 2: Number of drugs prescribed since 2016","title":"Examples: PIS data","text":"slightly complicated example involves summing total number items prescribed, counting transactions since 2016—words, paid_date 1 January 2016. , perform sum num_items column, use filter remove rows prior date. filter type \"date_gt_eq\", means greater equal .","code":"drugs_since_2016_filepath <- eider_example(\"num_prescriptions_since_2016.json\") writeLines(readLines(drugs_since_2016_filepath)) #> { #>   \"source_table\": \"pis\", #>   \"transformation_type\": \"sum\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"aggregation_column\": \"num_items\", #>   \"output_feature_name\": \"num_prescriptions_since_2016\", #>   \"filter\": { #>     \"column\": \"paid_date\", #>     \"type\": \"date_gt_eq\", #>     \"value\": \"2016-01-01\" #>   } #> } res <- run_pipeline(   data_sources = list(pis = pis_data_filepath),   feature_filenames = drugs_since_2016_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id                           <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12,… #> $ num_prescriptions_since_2016 <int> 10, 5, 19, 21, 5, 8, 12, 6, 8, 3, 4, 6, 7…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_pis.html","id":"feature-3-maximum-number-of-items-prescribed-in-a-single-transaction","dir":"Articles","previous_headings":"","what":"Feature 3: Maximum number of items prescribed in a single transaction","title":"Examples: PIS data","text":"warm-feature 4, write small feature looks maximum value num_items patient table. max transformation type, similar nunique sum seen , except run different aggregation function num_items column: instead counting unique values summing , pick maximum value.","code":"max_items_filepath <- eider_example(\"max_drugs_in_transaction.json\") writeLines(readLines(max_items_filepath)) #> { #>   \"source_table\": \"pis\", #>   \"transformation_type\": \"max\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"aggregation_column\": \"num_items\", #>   \"output_feature_name\": \"max_drugs_in_transaction\" #> } res <- run_pipeline(   data_sources = list(pis = pis_data_filepath),   feature_filenames = max_items_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id                       <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,… #> $ max_drugs_in_transaction <int> 4, 3, 5, 7, 5, 4, 4, 4, 6, 4, 5, 6, 3, 4, 3, …"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_pis.html","id":"feature-4-maximum-number-of-items-prescribed-in-a-single-day","dir":"Articles","previous_headings":"","what":"Feature 4: Maximum number of items prescribed in a single day","title":"Examples: PIS data","text":"Now, consider slightly complicated request: largest number items prescribed patient single day? Clearly, also max transformation type, need now somehow group together rows belong patient date, add values. , can use eider’s preprocessing functionality, described thoroughly preprocessing vignette. Specifically, can: group id paid_date columns; replace values num_items column sum values. JSON, instructions can specified using \"preprocessing\" key: full JSON file Feature 3, just preprocessing block added : Notice differences two feature columns : second (max_drugs_in_day) successfully aggregated transactions happened day, thus values (differ) larger.","code":"{     ...,     \"preprocessing\": {         \"on\": [\"id\", \"paid_date\"],         \"replace_with_sum\": \"num_items\"     } } max_items_day_filepath <- eider_example(\"max_drugs_in_day.json\") writeLines(readLines(max_items_day_filepath)) #> { #>   \"source_table\": \"pis\", #>   \"transformation_type\": \"max\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"aggregation_column\": \"num_items\", #>   \"preprocess\": { #>     \"on\": [ #>       \"id\", #>       \"paid_date\" #>     ], #>     \"replace_with_sum\": \"num_items\" #>   }, #>   \"output_feature_name\": \"max_drugs_in_day\" #> } res <- run_pipeline(   data_sources = list(pis = pis_data_filepath),   feature_filenames = c(max_items_filepath, max_items_day_filepath) )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 3 #> $ id                       <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,… #> $ max_drugs_in_transaction <int> 4, 3, 5, 7, 5, 4, 4, 4, 6, 4, 5, 6, 3, 4, 3, … #> $ max_drugs_in_day         <int> 4, 3, 8, 7, 5, 6, 8, 4, 6, 4, 5, 6, 3, 4, 3, …"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_smr04.html","id":"the-data","dir":"Articles","previous_headings":"","what":"The data","title":"Examples: SMR04 data","text":"specific vignette, using simulated SMR04 data. dataset contain every column specified , serves useful example real-life data may treated using eider. (Note data loaded eider, date columns automatically converted date type : need manual processing .) row table corresponds one episode; multiple episodes may associated stay. simplified table 7 columns: id, numeric patient ID; admission_date discharge_date, dates admission discharge episode; cis_marker, unique number associated stay (note necessarily unique different patient IDs); episode_within_cis, episode number within stay; specialty, specialty code episode.","code":"smr04_data <- utils::read.csv(smr04_data_filepath) |>   dplyr::mutate(     admission_date = lubridate::ymd(admission_date),     discharge_date = lubridate::ymd(discharge_date)   )  dplyr::glimpse(smr04_data) #> Rows: 217 #> Columns: 7 #> $ id                 <int> 1, 3, 3, 3, 11, 11, 2, 19, 19, 19, 16, 16, 4, 4, 16… #> $ admission_date     <date> 2015-07-15, 2016-05-03, 2016-05-04, 2016-05-05, 20… #> $ discharge_date     <date> 2015-07-15, 2016-05-04, 2016-05-05, 2016-05-06, 20… #> $ cis_marker         <int> 26, 20, 20, 20, 33, 33, 56, 70, 70, 70, 59, 59, 67,… #> $ episode_within_cis <int> 1, 1, 2, 3, 1, 2, 1, 1, 2, 3, 1, 2, 1, 2, 1, 2, 3, … #> $ admission_type     <int> 34, 19, NA, NA, 12, NA, 34, 40, NA, NA, 11, NA, 20,… #> $ specialty          <chr> \"G22\", \"G61\", \"G21\", \"G4\", \"G63\", \"G6\", \"G22\", \"G1\"…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_smr04.html","id":"feature-1-number-of-episodes-associated-with-a-psychotherapy-specialty","dir":"Articles","previous_headings":"","what":"Feature 1: Number of episodes associated with a psychotherapy specialty","title":"Examples: SMR04 data","text":"begin simple example: counting number episodes (.e. number rows) associated psychotherapy specialty, corresponds codes \"G6\", \"G61\", \"G62\", \"G63\". fairly straightforward count transformation_type, filter select values. can, principle, express compound filter type \"\", following shows: However, filters type \"\", eider lets user specify multiple values compare , much compact. resulting feature definition follows:","code":"{   \"filter\": {     \"type\": \"or\",     \"subfilter\": {       \"g6\": {         \"column\": \"specialty\",         \"type\": \"in\",         \"value\": \"G6\"       },       \"g61\": {         \"column\": \"specialty\",         \"type\": \"in\",         \"value\": \"G61\"       },       \"g62\": {         \"column\": \"specialty\",         \"type\": \"in\",         \"value\": \"G62\"       },       \"g63\": {         \"column\": \"specialty\",         \"type\": \"in\",         \"value\": \"G63\"       }     }   } } pt_episodes_filepath <- eider_example(\"psychotherapy_episodes.json\") writeLines(readLines(pt_episodes_filepath)) #> { #>   \"source_table\": \"smr04\", #>   \"transformation_type\": \"count\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"output_feature_name\": \"num_psychotherapy_episodes\", #>   \"filter\": { #>     \"column\": \"specialty\", #>     \"type\": \"in\", #>     \"value\": [ #>       \"G6\", #>       \"G61\", #>       \"G62\", #>       \"G63\" #>     ] #>   } #> } res <- run_pipeline(   data_sources = list(smr04 = smr04_data_filepath),   feature_filenames = pt_episodes_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id                         <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1… #> $ num_psychotherapy_episodes <int> 3, 5, 2, 3, 5, 1, 1, 3, 0, 2, 1, 6, 4, 3, 9…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_smr04.html","id":"feature-2-number-of-stays-associated-with-a-psychotherapy-specialty","dir":"Articles","previous_headings":"","what":"Feature 2: Number of stays associated with a psychotherapy specialty","title":"Examples: SMR04 data","text":"Next, count number stays associated psychotherapy specialty. slightly complicated, row corresponds episode, stay: thus, simply count number rows table. Instead, need count number unique cis_marker values associated psychotherapy specialty, cis_marker corresponds different stay. means transformation type \"nunique\", aggregation column \"cis_marker\".","code":"pt_stays_filepath <- eider_example(\"psychotherapy_stays.json\") writeLines(readLines(pt_stays_filepath)) #> { #>   \"source_table\": \"smr04\", #>   \"transformation_type\": \"nunique\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"aggregation_column\": \"cis_marker\", #>   \"output_feature_name\": \"num_psychotherapy_stays\", #>   \"filter\": { #>     \"column\": \"specialty\", #>     \"type\": \"in\", #>     \"value\": [ #>       \"G6\", #>       \"G61\", #>       \"G62\", #>       \"G63\" #>     ] #>   } #> } res <- run_pipeline(   data_sources = list(smr04 = smr04_data_filepath),   feature_filenames = pt_stays_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id                      <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, … #> $ num_psychotherapy_stays <int> 2, 4, 2, 3, 4, 1, 1, 2, 0, 2, 1, 4, 3, 2, 6, 1…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_smr04.html","id":"interlude-adding-data-sources-on-the-fly","dir":"Articles","previous_headings":"","what":"Interlude: Adding data sources on-the-fly","title":"Examples: SMR04 data","text":"last three features concerned number days spent hospital. principle, can easily calculated data already : taking discharge date subtracting admission date, can obtain length episode. eider yet possess functionality preprocess tables way (adding new columns). However, package allow perform calculation (e.g. using dplyr), add new table pipeline new data source. Specifically, data sources necessarily need CSV filenames; can simply data frames . Let’s construct new data frame: subsequent sections, ’ll provide new data frame data source run_pipeline().","code":"smr04_with_days_data <- smr04_data |>   dplyr::mutate(days_in_hospital = as.numeric(discharge_date - admission_date))  dplyr::glimpse(smr04_with_days_data) #> Rows: 217 #> Columns: 8 #> $ id                 <int> 1, 3, 3, 3, 11, 11, 2, 19, 19, 19, 16, 16, 4, 4, 16… #> $ admission_date     <date> 2015-07-15, 2016-05-03, 2016-05-04, 2016-05-05, 20… #> $ discharge_date     <date> 2015-07-15, 2016-05-04, 2016-05-05, 2016-05-06, 20… #> $ cis_marker         <int> 26, 20, 20, 20, 33, 33, 56, 70, 70, 70, 59, 59, 67,… #> $ episode_within_cis <int> 1, 1, 2, 3, 1, 2, 1, 1, 2, 3, 1, 2, 1, 2, 1, 2, 3, … #> $ admission_type     <int> 34, 19, NA, NA, 12, NA, 34, 40, NA, NA, 11, NA, 20,… #> $ specialty          <chr> \"G22\", \"G61\", \"G21\", \"G4\", \"G63\", \"G6\", \"G22\", \"G1\"… #> $ days_in_hospital   <dbl> 0, 1, 1, 1, 2, 0, 0, 2, 2, 2, 0, 0, 4, 0, 2, 1, 0, …"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_smr04.html","id":"feature-3-total-number-of-days-spent-in-hospital","dir":"Articles","previous_headings":"","what":"Feature 3: Total number of days spent in hospital","title":"Examples: SMR04 data","text":"new column, can now calculate total number days patient spent hospital. just requires sum transformation, act column just added, called days_in_hospital. Notice feature specifies different \"source_table\". new identifier can passed run_pipeline(), together data frame calculated .","code":"total_days_filepath <- eider_example(\"days_in_smr04.json\") writeLines(readLines(total_days_filepath)) #> { #>   \"source_table\": \"smr04_with_days\", #>   \"transformation_type\": \"sum\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"aggregation_column\": \"days_in_hospital\", #>   \"output_feature_name\": \"total_days_in_hospital\" #> } res <- run_pipeline(   data_sources = list(smr04_with_days = smr04_with_days_data),   feature_filenames = total_days_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id                     <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1… #> $ total_days_in_hospital <dbl> 6, 15, 6, 8, 13, 5, 12, 9, 3, 7, 7, 7, 11, 6, 1…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_smr04.html","id":"feature-4-longest-single-stay-in-hospital","dir":"Articles","previous_headings":"","what":"Feature 4: Longest single stay in hospital","title":"Examples: SMR04 data","text":"feature, going calculate longest single stay hospital patient. , need add number days spent episode within stay, take maximum values. overall action take maximum, max transformation type appropriate . However, summation must accomplished preprocessing step. step, need group data id cis_marker columns, replace values days_in_hospital sums days episodes. give us table row still corresponds episode, days_in_hospital column modified contain values stay. details preprocessing, see corresponding vignette.","code":"longest_stay_filepath <- eider_example(\"longest_stay.json\") writeLines(readLines(longest_stay_filepath)) #> { #>   \"source_table\": \"smr04_with_days\", #>   \"transformation_type\": \"max\", #>   \"grouping_column\": \"id\", #>   \"absent_default_value\": 0, #>   \"preprocess\": { #>     \"on\": [ #>       \"id\", #>       \"cis_marker\" #>     ], #>     \"replace_with_sum\": [ #>       \"days_in_hospital\" #>     ] #>   }, #>   \"aggregation_column\": \"days_in_hospital\", #>   \"output_feature_name\": \"longest_stay\" #> } res <- run_pipeline(   data_sources = list(smr04_with_days = smr04_with_days_data),   feature_filenames = longest_stay_filepath )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 2 #> $ id           <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,… #> $ longest_stay <dbl> 4, 5, 4, 3, 4, 3, 5, 6, 1, 3, 5, 3, 6, 4, 4, 3, 7, 7, 7, 6"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/examples_smr04.html","id":"putting-it-all-together","dir":"Articles","previous_headings":"","what":"Putting it all together","title":"Examples: SMR04 data","text":"Just good measure, let’s run entire pipeline four features one go.","code":"res <- run_pipeline(   data_sources = list(     smr04 = smr04_data_filepath,     smr04_with_days = smr04_with_days_data   ),   feature_filenames = c(     pt_episodes_filepath,     pt_stays_filepath,     total_days_filepath,     longest_stay_filepath   ) )  dplyr::glimpse(res$features) #> Rows: 20 #> Columns: 5 #> $ id                         <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1… #> $ num_psychotherapy_episodes <int> 3, 5, 2, 3, 5, 1, 1, 3, 0, 2, 1, 6, 4, 3, 9… #> $ num_psychotherapy_stays    <int> 2, 4, 2, 3, 4, 1, 1, 2, 0, 2, 1, 4, 3, 2, 6… #> $ total_days_in_hospital     <dbl> 6, 15, 6, 8, 13, 5, 12, 9, 3, 7, 7, 7, 11, … #> $ longest_stay               <dbl> 4, 5, 4, 3, 4, 3, 5, 6, 1, 3, 5, 3, 6, 4, 4…"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/features.html","id":"features-as-json","dir":"Articles","previous_headings":"","what":"Features as JSON","title":"An overview of features","text":"Features JSON objects, association keys values tied together within curly braces. Keys always strings, values can strings, numbers, booleans, arrays, objects , shown example object . Conceptually, JSON objects similar R lists. correctly parsed eider, feature must contain specific set keys. keys shared across features : (string) source_table name table read . Note filename: unique identifier passed part data_sources argument run_pipeline(). Please see introductory vignette explanation . (string) output_feature_name determines name column final dataframe eider produces. can string like, long clashes multiple features; feature name \"id\" also reserved used. (string) grouping_column name column input dataframe feature calculated . feature column contain result calculation unique value column. case medical data, typically name column containing patient ID. remainder vignette, refer values within column “IDs”. (number; optional) absent_default_value value used IDs present input dataframe. eider calculates numeric features, number. omitted, eider insert NA values missing IDs. (string) transformation_type defines type calculation performed feature. transformation type may require extra set keys specified feature correctly calculated.","code":"{   \"key_1\": \"a string\",   \"key_2\": 1,   \"key_3\": true,   \"key_4\": [1, 2, 3],   \"key_5\": {     \"nested_key_1\": \"a string\",     \"nested_key_2\": 1   } }"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/features.html","id":"transformation-types","dir":"Articles","previous_headings":"","what":"Transformation types","title":"An overview of features","text":"available transformation types can split groups:","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/features.html","id":"counting","dir":"Articles","previous_headings":"Transformation types","what":"Counting","title":"An overview of features","text":"Transformation types: \"count\", \"present\" two simplest features \"count\", counts number occurrences ID dataset, \"present\", outputs 1 ID found dataset 0 . Examples \"count\" feature type provided &E features 1 2, well SMR04 feature 1. \"present\" feature type showcased &E feature 3, well LTC features 2 3.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/features.html","id":"summaries","dir":"Articles","previous_headings":"Transformation types","what":"Summaries","title":"An overview of features","text":"Transformation types: \"sum\", \"nunique\", \"mean\", \"median\", \"sd\", \"first\", \"last\", \"min\", \"max\" features act respect values specific column, require single extra key specified: (string) aggregation_column name column containing values aggregated. feature calculated unique ID aggregating values column. Example features summary functions include PIS features, also SMR04 features 2, 3, 4. cover transformation types \"nunique\", \"sum\", \"max\".","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/features.html","id":"time-based","dir":"Articles","previous_headings":"Transformation types","what":"Time-based","title":"An overview of features","text":"Transformation types: \"time_since\" time_since transformation type calculates period time given date first (last) date dataset ID. feature requires keys: (string) date_column name column containing dates used calculation. (string) cutoff_date date used reference point calculation. format YYYY-MM-DD. (boolean) from_first true, feature calculate time cutoff date first date dataset ID. false, calculate time cutoff date last date. (string) time_units unit time used calculation. can either \"days\" \"years\": year defined 365.25 days. Examples \"time_since\" features given &E feature 4 LTC feature 1.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/features.html","id":"combination-features","dir":"Articles","previous_headings":"Transformation types","what":"Combination features","title":"An overview of features","text":"Transformation types: \"combine_linear\", \"combine_min\", \"combine_max\" Combination features way combining results multiple features single feature. slightly different structure rest: broadly speaking, transformation types require subfeature key, object contains features combined. Combination features covered separate vignette.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/features.html","id":"preprocessing-and-filtering","dir":"Articles","previous_headings":"","what":"Preprocessing and filtering","title":"An overview of features","text":"may seem like large number possible calculations, offer way controlling parts input data considered. addition keys shown , (non-combination) features may also contain preprocess filter keys, perform transformations input table features calculated . Preprocessing refers modification values within table, whereas filtering modify values, allows rows pass set criteria considered calculating feature. Preprocessing performed prior filtering: thus, specified, filtering performed already-preprocessed values. preprocess filter keys JSON objects, detailed respectively preprocessing filtering vignettes.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/filtering.html","id":"basic-filters","dir":"Articles","previous_headings":"","what":"Basic filters","title":"Filtering","text":"basic filter accept rows value given column meets certain criterion. example, may want look rows value age column greater 18. three pieces information must encoded: (string) column: name column filter (string) type: type filter apply value: value compare . type must match type column specified. type key can take one following values: \"\" case, value key can either single value array multiple values. filers rows value column matches one provided values. \"gt\" / \"lt\" / \"gt_eq\" / \"lt_eq\" value column must greater , less , greater equal , less equal value respectively. filters, one value can passed. \"date_gt\" / \"date_lt\" / \"date_gt_eq\" / \"date_lt_eq\" , used dates. distinction mandatory JSON native date type, value must passed string format YYYY-MM-DD. Thus, example, assume column age contains integers, selects people 18, 19, 20 years old; likewise date_of_birth column contains dates, selects people born January 1, 2000. reminder, table filtered passed source_table key feature JSON. described introductory vignette.","code":"{     \"filter\": {         \"column\": \"age\",         \"type\": \"in\",         \"value\": [18, 19, 20]     } } {     \"filter\": {         \"column\": \"date_of_birth\",         \"type\": \"date_gt_eq\",         \"value\": \"2000-01-01\"     } }"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/filtering.html","id":"compound-filters","dir":"Articles","previous_headings":"","what":"Compound filters","title":"Filtering","text":"Filters may also combined using Boolean logic operators , , . Instead providing three keys column, type, value, type specified, together subfilter, object maps filter names filter objects. example probably easiest way explain . wanted select people 18, 19, 20 years old, write: filter name, age_filter, can string want: used logging purposes. Notice object age_filter refers , .e., just basic filter already described . filters work exactly way, sole difference accomplish meaningful results generally want subfilter object contain two filters work tandem. example, filters 18-year-olds height 180 (presumably centimetres; although depends input table!): , age_filter height_filter just names logging purposes, refer basic filters. Finally, note subfilters need necessarily basic filters, though: can compound filters . possible nest filters deeply like accomplish desired result.","code":"{     \"filter\": {         \"type\": \"not\",         \"subfilter\": {             \"age_filter\": {                 \"column\": \"age\",                 \"type\": \"in\",                 \"value\": [18, 19, 20]             }         }     } } {     \"column\": \"age\",     \"type\": \"in\",     \"value\": [18, 19, 20] } {     \"filter\": {         \"type\": \"and\",         \"subfilter\": {             \"age_filter\": {                 \"column\": \"age\",                 \"type\": \"in\",                 \"value\": [18]             },             \"height_filter\": {                 \"column\": \"height\",                 \"type\": \"gt\",                 \"value\": 180             }         }     } }"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/filtering.html","id":"examples","dir":"Articles","previous_headings":"","what":"Examples","title":"Filtering","text":"Consider following input table five rows: suppose like count number times person diagnosis “B”. transformation_type \"count\"; perform filtering, \"count\" simply return number times person appears dataframe. following JSON provided json_examples/filter1.json: Passing run_pipeline() give us following result: Instead , specify filter diagnosis column (json_examples/filter2.json), can achieve desired result: Note patient 3 count 0, never diagnosed “B”. specified absent_default_value key JSON. like find diagnoses “B” 2024, can add date filter mix, combine diagnosis filter filter (json_examples/filter3.json): Patient 2’s diagnosis excluded time corresponding entry came 2023.","code":"library(eider) input_table <- data.frame(   id = c(1, 1, 1, 2, 3),   date = as.Date(c(     \"2024-01-01\", \"2024-01-02\", \"2024-01-03\",     \"2023-01-01\", \"2023-01-01\"   )),   diagnosis = c(\"A\", \"B\", \"C\", \"B\", \"C\") ) input_table #>   id       date diagnosis #> 1  1 2024-01-01         A #> 2  1 2024-01-02         B #> 3  1 2024-01-03         C #> 4  2 2023-01-01         B #> 5  3 2023-01-01         C {   \"output_feature_name\": \"unfiltered_count\",   \"transformation_type\": \"count\",   \"source_table\": \"input_table\",   \"grouping_column\": \"id\",   \"absent_default_value\": 0 } results <- run_pipeline(   data_sources = list(input_table = input_table),   feature_filenames = \"json_examples/filter1.json\" )  results$features #>   id unfiltered_count #> 1  1                3 #> 2  2                1 #> 3  3                1 {   \"output_feature_name\": \"filtered_count\",   \"transformation_type\": \"count\",   \"source_table\": \"input_table\",   \"grouping_column\": \"id\",   \"absent_default_value\": 0,   \"filter\": {     \"column\": \"diagnosis\",     \"type\": \"in\",     \"value\": [       \"B\"     ]   } } results <- run_pipeline(   data_sources = list(input_table = input_table),   feature_filenames = \"json_examples/filter2.json\" )  results$features #>   id filtered_count #> 1  1              1 #> 2  2              1 #> 3  3              0 {   \"output_feature_name\": \"doubly_filtered_count\",   \"transformation_type\": \"count\",   \"source_table\": \"input_table\",   \"grouping_column\": \"id\",   \"absent_default_value\": 0,   \"filter\": {     \"type\": \"and\",     \"subfilter\": {       \"diagnosis_filter\": {         \"column\": \"diagnosis\",         \"type\": \"in\",         \"value\": [           \"B\"         ]       },       \"date_filter\": {         \"column\": \"date\",         \"type\": \"date_gt_eq\",         \"value\": \"2024-01-01\"       }     }   } } results <- run_pipeline(   data_sources = list(input_table = input_table),   feature_filenames = \"json_examples/filter3.json\" )  results$features #>   id doubly_filtered_count #> 1  1                     1 #> 2  2                     0 #> 3  3                     0"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/filtering.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See also","title":"Filtering","text":"Filtering used widely Gallery examples. See, example: PIS feature 2 SMR04 features 1 2 use basic filters; LTC examples use filters remove rows missing data (NA values); &E feature 2 doubly nested compound filter.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/logging.html","id":"logging-in-eider","dir":"Articles","previous_headings":"","what":"Logging in eider","title":"Logging and errors","text":"eider uses logger package log messages. messages eider logged either DEBUG level (eider e.g. parsing information JSON), TRACE level (functions eider log TRACE message containing execution context). running pipeline, can set logging level either: causes DEBUG messages displayed, : causes TRACE DEBUG messages displayed.","code":"logger::log_threshold(logger::DEBUG) logger::log_threshold(logger::TRACE)"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/logging.html","id":"errors-with-context","dir":"Articles","previous_headings":"","what":"Errors with context","title":"Logging and errors","text":"Additionally, execution context (usually restricted TRACE messages) also displayed eider runs error. run error provide enough information, please consider submitting issue. examples:","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/logging.html","id":"wrong-transformation-type","dir":"Articles","previous_headings":"Errors with context","what":"Wrong transformation type","title":"Logging and errors","text":"JSON (json_examples/logging1.json), invalid transformation_type specified. Notice resulting error tells JSON file error occurs .","code":"{   \"source_table\": \"ae2\",   \"transformation_type\": \"COUNT DRACULA\",   \"grouping_column\": \"id\",   \"output_feature_name\": \"something\" } run_pipeline(   data_sources = list(ae2 = eider_example(\"random_ae_data.csv\")),   feature_filenames = \"json_examples/logging1.json\" ) #> Error: #> ! Unknown transformation type: count dracula #> Context: #>  > featurise: json_examples/logging1.json"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/logging.html","id":"wrong-column-name","dir":"Articles","previous_headings":"Errors with context","what":"Wrong column name","title":"Logging and errors","text":"(json_examples/logging2.json), grouping_column specified, column exist input table.","code":"{   \"source_table\": \"ae2\",   \"transformation_type\": \"COUNT\",   \"grouping_column\": \"this_column_doesnt_exist\",   \"output_feature_name\": \"something\" } run_pipeline(   data_sources = list(ae2 = eider_example(\"random_ae_data.csv\")),   feature_filenames = \"json_examples/logging2.json\" ) #> Error: #> ! The column 'this_column_doesnt_exist' supplied for 'grouping_column' was not found in the input table. #> Context: #>  > featurise: json_examples/logging2.json #>  > featurise_count"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/logging.html","id":"data-type-mismatch","dir":"Articles","previous_headings":"Errors with context","what":"Data type mismatch","title":"Logging and errors","text":"example (json_examples/logging3.json) specifies table filtered retain rows diagnosis_1 equal \"string\", actual table, diagnosis_1 integer.","code":"{   \"source_table\": \"ae2\",   \"transformation_type\": \"COUNT\",   \"grouping_column\": \"id\",   \"output_feature_name\": \"something\",   \"filter\": {     \"column\": \"diagnosis_1\",     \"type\": \"in\",     \"value\": \"a string\"   } } run_pipeline(   data_sources = list(ae2 = eider_example(\"random_ae_data.csv\")),   feature_filenames = \"json_examples/logging3.json\" ) #> Error: #> ! The 'value' field of a filter object must be of the same type as the column to be filtered on. However, the column 'diagnosis_1' is of type 'integer', while the value given is of type 'character'. #> Context: #>  > featurise: json_examples/logging3.json #>  > featurise_count #>  > filter_basic"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/preprocessing.html","id":"motivation","dir":"Articles","previous_headings":"","what":"Motivation","title":"Preprocessing","text":"begin making case preprocessing can required certain features. Consider following data frame. (heavily simplified version example SMR04 data bundled package, can obtain using eider_example('random_smr04_data.csv').) , row episode; multiple episodes make continuous inpatient stay (hence abbreviation “cis”). cis_marker field used label stays, can thus used identify episodes belonging stay. case, episode_within_cis tells us order episodes within stay; information always present, though. table snippet, one patient: 3 distinct stays; second comprises 2 episodes. information can tricky perform filtering , admission_date discharge_date pertain episode, often interested stay-level data: example, patient first admitted hospital. Consider following question: many stays patient since 5 January 2016 diagnosis “B”? patient table, answer 2: 2016 2017 stays diagnosis “B”, stays ended 5 January 2016. naively try perform calculation without accounting dates, write something like json_examples/preprocessing1.json: Running give: got value 1, incorrect! gives? happens, filter applied episode, first episode 2016 stay ended 5 January, counted data. second episode 2016 stay also removed diagnosis “B”. third stay, 2017, counted.","code":"input_table <- data.frame(   id = c(1, 1, 1, 1),   admission_date = as.Date(c(     \"2015-01-01\", \"2016-01-01\", \"2016-01-04\", \"2017-01-01\"   )),   discharge_date = as.Date(c(     \"2015-01-05\", \"2016-01-04\", \"2016-01-08\", \"2017-01-08\"   )),   cis_marker = c(1, 2, 2, 3),   episode_within_cis = c(1, 1, 2, 1),   diagnosis = c(\"A\", \"B\", \"C\", \"B\") )  input_table #>   id admission_date discharge_date cis_marker episode_within_cis diagnosis #> 1  1     2015-01-01     2015-01-05          1                  1         A #> 2  1     2016-01-01     2016-01-04          2                  1         B #> 3  1     2016-01-04     2016-01-08          2                  2         C #> 4  1     2017-01-01     2017-01-08          3                  1         B {   \"output_feature_name\": \"naive\",   \"transformation_type\": \"nunique\",   \"source_table\": \"input_table\",   \"aggregation_column\": \"cis_marker\",   \"grouping_column\": \"id\",   \"absent_default_value\": 0,   \"filter\": {     \"type\": \"and\",     \"subfilter\": {       \"date_filter\": {         \"column\": \"discharge_date\",         \"type\": \"date_gt_eq\",         \"value\": \"2016-01-05\"       },       \"diagnosis_filter\": {         \"column\": \"diagnosis\",         \"type\": \"in\",         \"value\": [           \"B\"         ]       }     }   } } results <- run_pipeline(   data_sources = list(input_table = input_table),   feature_filenames = \"json_examples/preprocessing1.json\" )  results$features #>   id naive #> 1  1     1"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/preprocessing.html","id":"preprocessing-specification","dir":"Articles","previous_headings":"","what":"Preprocessing specification","title":"Preprocessing","text":"way eider approaches issue allow users preprocess data. accomplished specifying preprocess object feature JSON. case, merge episode dates stays, can say like: unique pair id cis_marker, replace value admission date earliest episodes, replace discharge date replaced latest episodes. dplyr terms, one write pipeline like : Notice dates episodes stay 2 now , reflect overall dates stay. Returning eider library, information (unsurprisingly) specified JSON. Including preprocess object feature cause input table modified : preprocess object contains one mandatory key: (array strings) \"\": names columns data grouped preprocessing several optional keys can provided, corresponding operations performed. keys refer column names: (array strings) \"retain_min\": retain minimum value within group (array strings) \"retain_max\": retain maximum value within group (array strings) \"replace_with_sum\": sum values within group replace original values sum Columns may specified one keys (.e., preprocess column twice).","code":"processed_table <- input_table |>   dplyr::group_by(id, cis_marker) |>   dplyr::mutate(     admission_date = min(admission_date),     discharge_date = max(discharge_date)   ) |>   dplyr::ungroup()  processed_table #> # A tibble: 4 × 6 #>      id admission_date discharge_date cis_marker episode_within_cis diagnosis #>   <dbl> <date>         <date>              <dbl>              <dbl> <chr>     #> 1     1 2015-01-01     2015-01-05              1                  1 A         #> 2     1 2016-01-01     2016-01-08              2                  1 B         #> 3     1 2016-01-01     2016-01-08              2                  2 C         #> 4     1 2017-01-01     2017-01-08              3                  1 B {   \"preprocess\": {     \"on\": [\"id\", \"cis_marker\"],     \"retain_min\": [\"admission_date\"],     \"retain_max\": [\"discharge_date\"]   }, }"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/preprocessing.html","id":"returning-to-the-example","dir":"Articles","previous_headings":"","what":"Returning to the example","title":"Preprocessing","text":"can now rewrite feature JSON include preprocessing step (json_examples/preprocessing2.json): rerunning pipeline gives us correct value 2. Note although preprocess object placed filter object JSON, preprocessing always done prior filtering. order keys JSON effect whatsoever result.","code":"{   \"output_feature_name\": \"correct\",   \"transformation_type\": \"nunique\",   \"source_table\": \"input_table\",   \"aggregation_column\": \"cis_marker\",   \"grouping_column\": \"id\",   \"absent_default_value\": 0,   \"filter\": {     \"type\": \"and\",     \"subfilter\": {       \"date_filter\": {         \"column\": \"discharge_date\",         \"type\": \"date_gt_eq\",         \"value\": \"2016-01-05\"       },       \"diagnosis_filter\": {         \"column\": \"diagnosis\",         \"type\": \"in\",         \"value\": [           \"B\"         ]       }     }   },   \"preprocess\": {     \"on\": [       \"id\",       \"cis_marker\"     ],     \"retain_min\": [       \"admission_date\"     ],     \"retain_max\": [       \"discharge_date\"     ]   } } results <- run_pipeline(   data_sources = list(input_table = input_table),   feature_filenames = \"json_examples/preprocessing2.json\" )  results$features #>   id correct #> 1  1       2"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/preprocessing.html","id":"an-example-for-replace_with_sum","dir":"Articles","previous_headings":"","what":"An example for replace_with_sum","title":"Preprocessing","text":"motivate use replace_with_sum, can add column previous data frame denote length episode: Now consider different question, : many stays patient lasted week ? answer , need first sum days stay, can filter based sum. accomplished json_examples/preprocessing3.json:","code":"input_table_with_sum <- input_table |>   dplyr::mutate(days = as.numeric(discharge_date - admission_date))  input_table_with_sum #>   id admission_date discharge_date cis_marker episode_within_cis diagnosis days #> 1  1     2015-01-01     2015-01-05          1                  1         A    4 #> 2  1     2016-01-01     2016-01-04          2                  1         B    3 #> 3  1     2016-01-04     2016-01-08          2                  2         C    4 #> 4  1     2017-01-01     2017-01-08          3                  1         B    7 {   \"output_feature_name\": \"using_sum\",   \"transformation_type\": \"nunique\",   \"source_table\": \"input_table\",   \"aggregation_column\": \"cis_marker\",   \"grouping_column\": \"id\",   \"absent_default_value\": 0,   \"filter\": {     \"column\": \"days\",     \"type\": \"gt_eq\",     \"value\": 7   },   \"preprocess\": {     \"on\": [       \"id\",       \"cis_marker\"     ],     \"replace_with_sum\": [       \"days\"     ]   } } results <- run_pipeline(   data_sources = list(input_table = input_table_with_sum),   feature_filenames = \"json_examples/preprocessing3.json\" )  results$features #>   id using_sum #> 1  1         2"},{"path":"https://alan-turing-institute.github.io/eider/docs/articles/preprocessing.html","id":"see-also","dir":"Articles","previous_headings":"","what":"See also","title":"Preprocessing","text":"Gallery section contains two examples preprocessing action: PIS feature 4 SMR04 feature 4 use replace_with_sum preprocessing function.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Catalina Vallejos. Contributor. Louis Aslett. Contributor. Simon Rogers. Contributor. Camila Rangel Smith. Maintainer, contributor. Helen Duncan Little. Author. Jonathan Yong. Author. Alan Turing Institute. Copyright holder, funder.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Duncan Little H, Yong J (2026). eider: Declarative Feature Extraction Tabular Data Records. R package version 1.0.1, https://github.com/alan-turing-institute/eider.","code":"@Manual{,   title = {eider: Declarative Feature Extraction from Tabular Data Records},   author = {Helen {Duncan Little} and Jonathan Yong},   year = {2026},   note = {R package version 1.0.1},   url = {https://github.com/alan-turing-institute/eider}, }"},{"path":"https://alan-turing-institute.github.io/eider/docs/index.html","id":"eider-","dir":"","previous_headings":"","what":"Declarative Feature Extraction from Tabular Data Records","title":"Declarative Feature Extraction from Tabular Data Records","text":"eider R package extracting machine learning features tabular data, particular health records, declarative manner. Features specified JSON objects contain necessary information required perform given calculation. example, following calculates number total rows per patient id table labelled ae2 (details specify table function documentation). output column named total_ae_attendances, containing number rows per patient, value 0 patients appear ae2 table. declarative approach provides alternative traditional, imperative-style, dplyr pipelines can difficult reason , especially series features extracted merged together. features specified without reference specific programming language paradigm, also encourages code concise, easy read, maintainable. eider collaboration Alan Turing Institute, Public Health Scotland, Universities Edinburgh Durham. grew desire generalise feature extraction process health data, specifically SPARRA (Scottish Patients Risk Readmission Admission) project (GitHub repo), allow similar analyses carried different contexts.","code":"{   \"source_table\": \"ae2\",   \"transformation_type\": \"COUNT\",   \"grouping_column\": \"id\",   \"absent_default_value\": 0,   \"output_feature_name\": \"total_ae_attendances\" }"},{"path":"https://alan-turing-institute.github.io/eider/docs/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Declarative Feature Extraction from Tabular Data Records","text":"Install via CRAN: Alternatively, install eider source code GitHub using:","code":"install.packages(\"eider\") install.packages(\"devtools\") devtools::install_github(\"alan-turing-institute/eider\", build_vignettes = TRUE)"},{"path":"https://alan-turing-institute.github.io/eider/docs/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Declarative Feature Extraction from Tabular Data Records","text":"package documentation available online. particular, package articles contain series vignettes provide detailed guidance package features.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/index.html","id":"development","dir":"","previous_headings":"","what":"Development","title":"Declarative Feature Extraction from Tabular Data Records","text":"making changes library , first clone repository: need install lintr, pkgdown, devtools R packages build documentation, run tests, lint. , repository root, can use following commands: make doc generates function documentation, also generates README.md file README.rmd make lint lints project directory make test runs tests can also use pre-commit run committing, ensure commit incomplete code. Firstly, install pre-commit according instructions webpage . run pre-commit install. vignettes? Well, building vignettes slightly complicated. can perform one-time build R console using pkgdown::build_site(), running every time edit file gets tiring quickly. automate , first install package make install, install working version Python also entr (latter available Homebrew via brew install entr). run make vig: monitor vignette RMarkdown files, rebuild vignettes time changed, launch HTTP server port 8000 view files. change library code run make install rerunning make vig.","code":"git clone git@github.com:alan-turing-institute/eider.git"},{"path":"https://alan-turing-institute.github.io/eider/docs/index.html","id":"releasing-a-new-version","dir":"","previous_headings":"","what":"Releasing a new version","title":"Declarative Feature Extraction from Tabular Data Records","text":"release new version package, first update version number running following R shell. following prompt new version number (major, minor, patch), can choose according semantic versioning considerations: Make sure CRAN checks pass : ’s probably also good make sure CI passing GitHub. ’re ready, commit push GitHub. :","code":"usethis::use_version() devtools::check(remote = TRUE, manual = TRUE) devtools::submit_cran()"},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/eider-package.html","id":null,"dir":"Reference","previous_headings":"","what":"eider: Declarative Feature Extraction from Tabular Data Records — eider-package","title":"eider: Declarative Feature Extraction from Tabular Data Records — eider-package","text":"eider lightweight package processing tabular data declarative fashion. get started, see: vignette(\"eider\")","code":""},{"path":[]},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/eider-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"eider: Declarative Feature Extraction from Tabular Data Records — eider-package","text":"Maintainer: Camila Rangel Smith crangelsmith@turing.ac.uk (ORCID) [contributor] Authors: Helen Duncan Little hduncan@turing.ac.uk (ORCID) Jonathan Yong jyong@turing.ac.uk (ORCID) contributors: Catalina Vallejos catalina.vallejos@ed.ac.uk (ORCID) [contributor] Louis Aslett louis.aslett@durham.ac.uk (ORCID) [contributor] Simon Rogers simon.rogers@nhs.scot (ORCID) [contributor] Alan Turing Institute [copyright holder, funder]","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/eider_example.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain filepaths to example data and JSON features — eider_example","title":"Obtain filepaths to example data and JSON features — eider_example","text":"Return absolute path example data JSON features provided package. files contained package inst/extdata directory.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/eider_example.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain filepaths to example data and JSON features — eider_example","text":"","code":"eider_example(file = NULL)"},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/eider_example.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain filepaths to example data and JSON features — eider_example","text":"file filename return full path . Defaults NULL, case return vector valid filenames.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/eider_example.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain filepaths to example data and JSON features — eider_example","text":"string containing full path file, vector filenames","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/eider_example.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Obtain filepaths to example data and JSON features — eider_example","text":"","code":"eider_example() #>  [1] \"ae_attendances_neurology_2017.json\" \"ae_total_attendances.json\"          #>  [3] \"days_in_smr04.json\"                 \"days_since_last_ae.json\"            #>  [5] \"distinct_bnf_prescriptions.json\"    \"has_asthma.json\"                    #>  [7] \"has_visited_ae.json\"                \"longest_stay.json\"                  #>  [9] \"max_drugs_in_day.json\"              \"max_drugs_in_transaction.json\"      #> [11] \"num_prescriptions_since_2016.json\"  \"number_of_ltcs.json\"                #> [13] \"psychotherapy_episodes.json\"        \"psychotherapy_stays.json\"           #> [15] \"random_ae_data.csv\"                 \"random_ltc_data.csv\"                #> [17] \"random_pis_data.csv\"                \"random_smr04_data.csv\"              #> [19] \"years_with_asthma.json\"             eider_example(\"random_ae_data.csv\") #> [1] \"/tmp/RtmpiKfwzZ/temp_libpath357d1cc17fe3/eider/extdata/random_ae_data.csv\""},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/run_pipeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform the entire feature transformation process — run_pipeline","title":"Perform the entire feature transformation process — run_pipeline","text":"Reads data feature specifications performs requisite transformations. Please see package vignettes detailed information JSON specification features.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/run_pipeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform the entire feature transformation process — run_pipeline","text":"","code":"run_pipeline(   data_sources,   feature_filenames = NULL,   response_filenames = NULL,   all_ids = NULL )"},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/run_pipeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform the entire feature transformation process — run_pipeline","text":"data_sources list, whose names unique identifiers data sources, whose values either data frame file path read . CSV files supported point time. feature_filenames vector file paths feature JSON specifications. Defaults NULL. response_filenames vector file paths response JSON specifications. Defaults NULL. all_ids vector unique numeric identifiers final feature table. given, determined taking union unique identifiers found input tables used least one feature.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/run_pipeline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform the entire feature transformation process — run_pipeline","text":"list following elementss: features: data frame features. first column ID column, always name id. Subsequent columns features, column names specified output_feature_name field JSON files. responses: data frame responses. structure features data frame.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/reference/run_pipeline.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform the entire feature transformation process — run_pipeline","text":"","code":"run_pipeline(   data_sources = list(ae = eider_example(\"random_ae_data.csv\")),   feature_filenames = eider_example(\"ae_total_attendances.json\") ) #> $features #>    id total_ae_attendances #> 1   0                    6 #> 2   1                    4 #> 3   2                    6 #> 4   3                    3 #> 5   4                    5 #> 6   5                    4 #> 7   6                    6 #> 8   7                    5 #> 9   8                    5 #> 10  9                   10 #> 11 10                    4 #> 12 11                    5 #> 13 12                    4 #> 14 13                    8 #> 15 14                    4 #> 16 15                    7 #> 17 16                    3 #> 18 17                    5 #> 19 18                    4 #> 20 19                    2 #>  #> $responses #>    id #> 1   0 #> 2   1 #> 3   2 #> 4   3 #> 5   4 #> 6   5 #> 7   6 #> 8   7 #> 9   8 #> 10  9 #> 11 10 #> 12 11 #> 13 12 #> 14 13 #> 15 14 #> 16 15 #> 17 16 #> 18 17 #> 19 18 #> 20 19 #>"},{"path":"https://alan-turing-institute.github.io/eider/docs/news/index.html","id":"eider-101","dir":"Changelog","previous_headings":"","what":"eider 1.0.1","title":"eider 1.0.1","text":"Bumped R minimum version 4.1; use |> instead %>%; define id global variable avoid conflicts dplyr.","code":""},{"path":"https://alan-turing-institute.github.io/eider/docs/news/index.html","id":"eider-100","dir":"Changelog","previous_headings":"","what":"eider 1.0.0","title":"eider 1.0.0","text":"CRAN release: 2024-05-13 Initial CRAN submission.","code":""}]

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to eider • eider</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Fira_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to eider">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eider</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/eider.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Features as JSON</h6></li>
    <li><a class="dropdown-item" href="../articles/features.html">An overview of features</a></li>
    <li><a class="dropdown-item" href="../articles/filtering.html">Filtering</a></li>
    <li><a class="dropdown-item" href="../articles/preprocessing.html">Preprocessing</a></li>
    <li><a class="dropdown-item" href="../articles/combination.html">Combination features</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Logging</h6></li>
    <li><a class="dropdown-item" href="../articles/logging.html">Logging and errors</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Gallery</h6></li>
    <li><a class="dropdown-item" href="../articles/examples_ae.html">Examples: A&amp;E data</a></li>
    <li><a class="dropdown-item" href="../articles/examples_ltc.html">Examples: LTC data</a></li>
    <li><a class="dropdown-item" href="../articles/examples_pis.html">Examples: PIS data</a></li>
    <li><a class="dropdown-item" href="../articles/examples_smr04.html">Examples: SMR04 data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/alan-turing-institute/eider/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to eider</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alan-turing-institute/eider/blob/main/vignettes/eider.Rmd" class="external-link"><code>vignettes/eider.Rmd</code></a></small>
      <div class="d-none name"><code>eider.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alan-turing-institute/eider" class="external-link">eider</a></span><span class="op">)</span></span></code></pre></div>
<p><code>eider</code> is a lightweight package for processing tabular
data in a declarative fashion. Users may specify a set of operations to
be performed on a table using JSON, which are then executed by the
package. The primary use case of <code>eider</code> is for extraction of
machine learning features from health data, but <code>eider</code> can
in principle be used for any kind of data.</p>
<p>The usage of <code>eider</code> in R source code itself is
straightforward, and consists of a single call to
<code><a href="../reference/run_pipeline.html">run_pipeline()</a></code>.</p>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>To illustrate this, we will construct some very simplistic data,
which may be, for example, a record of patients who attended their GP
and their associated complaints.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  attendance_reason <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_sources</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>attendances <span class="op">=</span> <span class="va">example_table</span><span class="op">)</span></span></code></pre></div>
<p>In practice, it is more likely that you will be reading in data from
a file instead. For example, if you had a CSV file called
<code>attendances.csv</code> in the current working directory, you could
just do:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_sources_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>attendances <span class="op">=</span> <span class="st">"attendances.csv"</span><span class="op">)</span></span></code></pre></div>
<p><code>eider</code> allows you to mix and match data sources, so you
could have some data in a CSV file and some in an R data frame:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_sources_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  attendances <span class="op">=</span> <span class="va">example_table</span>,   <span class="co"># A variable which has already been constructed</span></span>
<span>  other_data <span class="op">=</span> <span class="st">"other_data.csv"</span>  <span class="co"># A file to be read in</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This allows the user to, for example, perform preprocessing on a
portion of their data if so needed.</p>
</div>
<div class="section level2">
<h2 id="feature-specification">Feature specification<a class="anchor" aria-label="anchor" href="#feature-specification"></a>
</h2>
<p>Suppose we want to extract a feature corresponding to the total
number of times a patient attended for reason 6. <code>eider</code>
requires that the feature is specified as JSON, which looks like
this:</p>
<pre><code>{
  "transformation_type": "count",
  "source_table": "attendances",
  "grouping_column": "patient_id",
  "absent_default_value": 0,
  "output_feature_name": "total_attendances",
  "filter": {
    "column": "attendance_reason",
    "type": "in",
    "value": [
      6
    ]
  }
}</code></pre>
<ul>
<li>
<code>transformation_type</code> tells you what kind of overall
operation is being performed. This determines which other fields are
required in the JSON.</li>
<li>
<code>source_table</code> specifies the name of the data source to
be used in the list of data sources.</li>
<li>
<code>grouping_column</code> specifies the columns to group by.</li>
<li>
<code>absent_default_value</code> specifies what to do if there is
no data for a particular patient ID.</li>
<li>
<code>output_feature_name</code> specifies the name of the column to
be created in the output table.</li>
<li>
<code>filter</code> is a filter object which is used to select rows
from the input table which match particular conditions.</li>
</ul>
<p>Subsequent vignettes will go into more detail about the different
types of transformations and the required JSON fields for each of
them.</p>
</div>
<div class="section level2">
<h2 id="performing-the-transformation">Performing the transformation<a class="anchor" aria-label="anchor" href="#performing-the-transformation"></a>
</h2>
<p>To obtain the desired feature, we can place the JSON above in a file
(here <a href="https://github.com/alan-turing-institute/eider/blob/main/vignettes/json_examples/eider.json" class="external-link"><code>json_examples/eider.json</code></a>)
and simply do:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/run_pipeline.html">run_pipeline</a></span><span class="op">(</span></span>
<span>  data_sources <span class="op">=</span> <span class="va">data_sources</span>,</span>
<span>  feature_filenames <span class="op">=</span> <span class="st">"json_examples/eider.json"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $features</span></span>
<span><span class="co">#&gt;   id total_attendances</span></span>
<span><span class="co">#&gt; 1  1                 2</span></span>
<span><span class="co">#&gt; 2  2                 2</span></span>
<span><span class="co">#&gt; 3  3                 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $responses</span></span>
<span><span class="co">#&gt;   id</span></span>
<span><span class="co">#&gt; 1  1</span></span>
<span><span class="co">#&gt; 2  2</span></span>
<span><span class="co">#&gt; 3  3</span></span></code></pre></div>
<p>As expected, both patients 1 and 2 have attended for reason 6 twice,
and patient 3 has not.</p>
<p><code><a href="../reference/run_pipeline.html">run_pipeline()</a></code> returns a list of two data frames, called
<em>features</em> and <em>responses</em> respectively. These refer to
data used for training machine learning models: <em>features</em> are
the independent variables (i.e. <code>X</code>), and <em>responses</em>
are the dependent variables (i.e. <code>y</code>). For consistency,
<code>eider</code> always returns both of these data frames and ensures
that both of them have the same list of IDs. Responses may be specified
in exactly the same way as features, but using the
<code>response_filenames</code> argument instead of
<code>feature_filenames</code>.</p>
<p>As an alternative to placing the JSON in a file and providing the
filename to <code><a href="../reference/run_pipeline.html">run_pipeline()</a></code>, you can also provide the JSON
directly as a string:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">json_string</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">    "transformation_type": "count",</span></span>
<span><span class="st">    "source_table": "attendances",</span></span>
<span><span class="st">    "grouping_column": "patient_id",</span></span>
<span><span class="st">    "absent_default_value": 0,</span></span>
<span><span class="st">    "output_feature_name": "total_attendances",</span></span>
<span><span class="st">    "filter": {</span></span>
<span><span class="st">        "column": "attendance_reason",</span></span>
<span><span class="st">        "type": "in",</span></span>
<span><span class="st">        "value": [6]</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">}'</span></span>
<span></span>
<span><span class="fu"><a href="../reference/run_pipeline.html">run_pipeline</a></span><span class="op">(</span></span>
<span>  data_sources <span class="op">=</span> <span class="va">data_sources</span>,</span>
<span>  feature_filenames <span class="op">=</span> <span class="va">json_string</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; $features</span></span>
<span><span class="co">#&gt;   id total_attendances</span></span>
<span><span class="co">#&gt; 1  1                 2</span></span>
<span><span class="co">#&gt; 2  2                 2</span></span>
<span><span class="co">#&gt; 3  3                 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $responses</span></span>
<span><span class="co">#&gt;   id</span></span>
<span><span class="co">#&gt; 1  1</span></span>
<span><span class="co">#&gt; 2  2</span></span>
<span><span class="co">#&gt; 3  3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>If you want to read a more step-by-step guide to the features of
<code>eider</code>, move on to <a href="features.html">the next
vignette</a>, which covers the different types of features that
<code>eider</code> lets you define.</p>
<p>Alternatively, jump ahead to the <a href="examples_ae.html">gallery
section</a> to see some examples of features that you might use
<code>eider</code> to calculate.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Camila Rangel Smith, Helen Duncan Little, Jonathan Yong, The Alan Turing Institute.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
